# TickTock-Align-NPU Library

████████╗██╗ ██████╗██╗  ██╗████████╗ ██████╗  ██████╗██╗  ██╗
╚══██╔══╝██║██╔════╝██║ ██╔╝╚══██╔══╝██╔═══██╗██╔════╝██║ ██╔╝
   ██║   ██║██║     █████╔╝    ██║   ██║   ██║██║     █████╔╝ 
   ██║   ██║██║     ██╔═██╗    ██║   ██║   ██║██║     ██╔═██╗ 
   ██║   ██║╚██████╗██║  ██╗   ██║   ╚██████╔╝╚██████╗██║  ██╗
   ╚═╝   ╚═╝ ╚═════╝╚═╝  ╚═╝   ╚═╝    ╚═════╝  ╚═════╝╚═╝  ╚═╝

**输入**: NPU-Lib 文件夹中的建筑物图像序列  
**输出**: NPU-Lib-Align 文件夹中的对齐图像

基于计算机视觉技术的建筑物图像对齐库，能够自动将图像序列与参考图像进行精确对齐。使用第一张图像或手动指定的图像作为参考，其他图像自动与之对齐。

## 🚀 快速开始

### 方法1: 一键启动（推荐）
```bash
# Windows用户：双击运行
run_demo.bat

# 或在命令行执行
.\run_demo.bat
```

### 方法2: Python命令行
```bash
# 安装依赖
pip install -r requirements.txt

# 完整流程（图像对齐 + 延时摄影）
python demo.py

# 仅图像对齐
python demo.py --align-only

# 仅延时摄影（需要已对齐的图像）  
python demo.py --video-only

# 自定义参数
python demo.py --input NPU-Lib --output NPU-Lib-Align --video Video --reference 2
```

### 方法3: 分步执行
```bash
# 步骤1：图像对齐
python align_lib.py

# 步骤2：延时摄影
python create_timelapse.py
```

## 🎯 核心功能

### 🔄 智能图像对齐
- **SIFT特征检测**: 精确识别图像特征点
- **FLANN快速匹配**: 高效的特征点匹配算法
- **RANSAC鲁棒估计**: 抗干扰的单应性矩阵计算
- **批量处理**: 自动处理整个文件夹的图像序列
- **智能错误处理**: 处理特征检测失败等异常情况

### 🎬 专业延时摄影
- **多质量输出**: 自动生成预览版、标准版、高质量版
- **智能编码**: H.264编码确保广泛兼容性
- **自适应分辨率**: 自动调整到合适的输出分辨率
- **FFmpeg集成**: 基于业界标准的视频处理工具

## 📁 项目结构

```
TickTock-Align-NPULibrary/
├── NPU-Lib/                    # 输入：原始建筑物图像序列
│   ├── IMG_20250601_114129.jpg
│   ├── IMG_20250602_102318.jpg
│   └── ...
├── NPU-Lib-Align/             # 输出：对齐后的图像
├── Video/                      # 输出：延时摄影视频
│   ├── timelapse_preview.mp4   # 快速预览版 (30fps)
│   ├── timelapse_standard.mp4  # 标准版 (15fps)
│   └── timelapse_hq.mp4        # 高质量版 (10fps)
├── demo.py                     # 主程序（整合版）
├── align_lib.py               # 图像对齐核心库  
├── create_timelapse.py        # 延时摄影制作工具
├── test_demo.py               # 环境测试脚本
├── run_demo.bat               # 一键启动脚本
├── requirements.txt           # 依赖包列表
├── USAGE.md                   # 详细使用指南
└── README.md                  # 项目说明
```

## 🎬 工作流程

```
📷 原始图像序列 (NPU-Lib)
    ↓
🔄 SIFT特征检测 & FLANN匹配
    ↓  
📐 RANSAC单应性矩阵估计
    ↓
✨ 透视变换图像对齐
    ↓
💾 对齐图像保存 (NPU-Lib-Align)
    ↓
🎬 FFmpeg延时摄影制作
    ↓
🎥 多质量视频输出 (Video/)
```

## � 系统要求

### 必需软件
- **Python 3.6+**
- **OpenCV 4.0+** 
- **NumPy 1.19+**
- **FFmpeg** (延时摄影功能)

### 支持平台
- Windows 10/11
- Linux (Ubuntu 18.04+) 
- macOS 10.14+

### 推荐硬件
- 内存：8GB+ (高分辨率图像处理)
- 存储：充足空间存储图像和视频
- CPU：多核处理器提升处理速度

## 📖 详细文档

- 📋 [完整使用指南](USAGE.md) - 详细的使用说明和API文档
- 🔧 [环境配置](requirements.txt) - 依赖包安装说明
- 🧪 [测试验证](test_demo.py) - 环境和功能测试

## 🎯 适用场景

- 🏗️ **建筑物延时摄影** - 建筑施工过程记录
- 🌅 **城市景观变化** - 城市发展变迁记录  
- 🔬 **科研观测** - 长期观测数据可视化
- 🎨 **艺术创作** - 创意延时摄影项目
- 📊 **数据可视化** - 时间序列数据展示